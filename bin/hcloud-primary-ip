#!/usr/bin/env -S bash -euo pipefail

readonly subcommand='primary-ip'

selected=$(
  hcloud "${subcommand}" list \
    | fzf \
        --style minimal \
        --header-lines=1 \
        --nth=.. \
        --with-nth=.. \
        --preview "hcloud ${subcommand} describe {1} | bat --theme='Nord' --plain --color=always --language=yaml" \
        --preview-window='right,50%' \
        --prompt='Select ‚ùØ ' \
        --layout=reverse \
    | awk '{print $1}'
)

# Exit if nothing was selected (fzf aborted)
[ -n "$selected" ] || exit 0

# Extract the first column (ID) and describe it
echo "$(awk '{print $1}' <<<"$selected")"

